CREATE DATABASE db1;
USE db1;

CREATE TABLE CUSTOMERS(
    ID INT PRIMARY KEY,
    NAME VARCHAR(50),
    AGE INT,
    ADDRESS VARCHAR(50),
    SALARY DECIMAL(10,2)
);

INSERT INTO CUSTOMERS VALUES (1, 'Ramesh', 32, 'Ahmedabad', 2000.00);
INSERT INTO CUSTOMERS VALUES (2, 'Khilan', 25, 'Delhi', 1500.00);
INSERT INTO CUSTOMERS VALUES (3, 'Kaushik', 23, 'Kota', 2000.00);
INSERT INTO CUSTOMERS VALUES (4, 'Chaitali', 25, 'Mumbai', 6500.00);
INSERT INTO CUSTOMERS VALUES (5, 'Hardik', 27, 'Bhopal', 8500.00);
INSERT INTO CUSTOMERS VALUES (6, 'Komal', 22, 'MP', 4500.00);
INSERT INTO CUSTOMERS VALUES (7, 'Muffy', 24, 'Indore', 10000.00);

CREATE VIEW CUSTOMERS_VIEW AS 
SELECT NAME, AGE 
FROM CUSTOMERS;

SELECT * FROM CUSTOMERS_VIEW;

UPDATE CUSTOMERS_VIEW 
SET AGE = 35 
WHERE NAME = 'Ramesh';

CREATE TABLE CUSTOMERS2(
    ID INT PRIMARY KEY,
    NAME VARCHAR(50) NOT NULL,
    AGE INT,
    EMAIL VARCHAR(100) NOT NULL
);

CREATE VIEW CUSTOMERS_VIEW_FULL AS
SELECT ID, NAME, AGE, EMAIL
FROM CUSTOMERS2;

INSERT INTO CUSTOMERS_VIEW_FULL (ID, NAME, AGE, EMAIL)
VALUES (101, 'Ravi Kumar', 25, 'ravi@example.com');

CREATE VIEW CUSTOMERS_VIEW_PARTIAL AS
SELECT ID, NAME 
FROM CUSTOMERS2;

DELETE FROM CUSTOMERS_VIEW 
WHERE AGE = 22;

DROP VIEW CUSTOMERS_VIEW;

CREATE TABLE Departments(
    DeptID INT PRIMARY KEY,
    DeptName VARCHAR(100)
);

CREATE TABLE Employees(
    EmpID INT PRIMARY KEY,
    EmpName VARCHAR(100),
    Salary INT,
    DeptID INT,
    FOREIGN KEY (DeptID) REFERENCES Departments(DeptID)
);

CREATE VIEW DepartmentEmployees AS
SELECT D.DeptName, E.EmpName, E.Salary
FROM Employees E
JOIN Departments D ON E.DeptID = D.DeptID;
